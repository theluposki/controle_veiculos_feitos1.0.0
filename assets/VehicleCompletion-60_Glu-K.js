import{_ as k,r as o,o as q,a as i,c as d,b as t,w as h,v as m,F as V,e as I,t as v,p as O,f as j}from"./index-RfDUoVVt.js";import{d as _}from"./dexie-SNI3UijA.js";const x=u=>(O("data-v-efa699b5"),u=u(),j(),u),S={class:"VehicleCompletion"},T={class:"inputs"},U=x(()=>t("i",{class:"ri-add-line"},null,-1)),E=[U],P={key:0,class:"list"},A={class:"marca"},B={class:"placa"},F={class:"qtd-peca"},H={class:"dataInput"},M={key:1,class:"dataEmpty"},R=x(()=>t("i",{class:"ri-share-forward-2-line"},null,-1)),z=[R],L={__name:"VehicleCompletion",setup(u){const n=o(null),l=o(null),c=o(null),p=o([]),r=o([]),f=o("");q(async()=>{p.value=await b(),r.value=await w(),r.value.length>0&&y()});async function w(){const e=new Date;return(await _.dados.where("data").aboveOrEqual(e.setHours(0,0,0,0)).toArray()).map(a=>({marca:a.marca,placa:a.placa,qtdPecas:a.qtdPecas,data:D(a.data)}))}function y(){const e=Object.keys(r.value[0]).join(",")+`
`,s=r.value.map(a=>Object.values(a).join(",")).join(`
`);f.value=e+s}function C(){const e=`Confira os dados do dia:


`+f.value;window.open("https://api.whatsapp.com/send?text="+encodeURIComponent(e))}const g=async()=>{if(!(!n.value||!l.value||!c.value))try{await _.dados.put({marca:n.value.toUpperCase(),placa:l.value.toUpperCase(),qtdPecas:c.value,data:new Date().getTime()}),p.value=await b(),r.value=await w(),y(),n.value=null,l.value=null,c.value=null}catch{console.error("Ouve um erro ao finalizar veículo.")}};async function b(){try{const e=new Date().setHours(0,0,0,0);return await _.dados.where("data").aboveOrEqual(e).toArray()}catch(e){console.error(`Error while searching data: ${e.stack||e}`)}}const D=e=>new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(new Date(e));return(e,s)=>(i(),d("div",S,[t("div",T,[h(t("input",{type:"text",tabindex:"1","onUpdate:modelValue":s[0]||(s[0]=a=>n.value=a),placeholder:"marca",style:{"text-transform":"uppercase"}},null,512),[[m,n.value]]),h(t("input",{type:"text",tabindex:"2","onUpdate:modelValue":s[1]||(s[1]=a=>l.value=a),placeholder:"placa",style:{"text-transform":"uppercase"}},null,512),[[m,l.value]]),h(t("input",{type:"text",tabindex:"3","onUpdate:modelValue":s[2]||(s[2]=a=>c.value=a),placeholder:"qtd peças"},null,512),[[m,c.value]]),t("button",{class:"btn",tabindex:"4",onClick:g},E)]),p.value.length>0?(i(),d("ul",P,[(i(!0),d(V,null,I(p.value,a=>(i(),d("li",{class:"item-list",key:a.id},[t("span",A,v(a.marca),1),t("span",B,v(a.placa),1),t("span",F,v(a.qtdPecas),1),t("span",H,v(D(a.data)),1)]))),128))])):(i(),d("div",M," Adicione um veículo. ")),t("div",{class:"btnShared",onClick:C},z)]))}},$=k(L,[["__scopeId","data-v-efa699b5"]]);export{$ as default};
